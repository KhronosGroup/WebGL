<!--AUTOGENERATED FILE - DO NOT EDIT - SEE Makefile--><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>WebGL WEBGL_depth_texture Extension Draft Specification</title>
<link rel="alternate" type="text/xml" href="extension.xml">
<link rel="stylesheet" type="text/css" href="../../resources/Khronos-WD.css">
</head>
<body>
<!--begin-logo--><div class="left"><a href="http://webgl.org/"><img alt="WebGL" height="72" src="../../resources/WebGL-Logo.png" width="156"></a></div>
<div class="right"><a href="http://khronos.org/"><img alt="Khronos" height="60" src="../../resources/KhronosGroup-3D.png" width="220"></a></div>
<div style="clear: both;"></div>
<br><!--end-logo--><h1>WebGL WEBGL_depth_texture Extension Draft Specification</h1>
<h2 class="no-toc">Name</h2>
<p>WEBGL_depth_texture</p>
<h2 class="no-toc">Contact</h2>
<p>
    <a href="https://www.khronos.org/webgl/public-mailing-list/">WebGL working group</a> (public_webgl 'at' khronos.org)
  </p>
<h2 class="no-toc">Contributors</h2>
<p>Members of the WebGL working group</p>
<p>Florian BÃ¶sch (pyalot 'at' gmail.com)</p>
<h2 class="no-toc">Version</h2>
<p> Last modified date: June 27, 2012<br>
          Revision: 8</p>
<h2 class="no-toc">Number</h2>
<p> WebGL extension #9</p>
<h2 class="no-toc">Dependencies</h2>
    <p> Written against the <a href="http://www.khronos.org/registry/webgl/specs/1.0/">WebGL API 1.0</a> specification. </p>
  <h2 class="no-toc">Overview</h2>
    <p>This extension exposes the
      <a href="http://angleproject.googlecode.com/svn/trunk/extensions/ANGLE_depth_texture.txt">ANGLE_depth_texture</a>
      functionality to WebGL. ANGLE_depth_texture provides a subset of the
      functionality from the OpenGL ES 2.0 extensions
      <a href="http://www.khronos.org/registry/gles/extensions/OES/OES_depth_texture.txt">OES_depth_texture</a>
      and
      <a href="http://www.khronos.org/registry/gles/extensions/OES/OES_packed_depth_stencil.txt">OES_packed_depth_stencil</a>, with certain restrictions added for portability reasons. Specifically:

      <ul>
      <li> ANGLE_depth_texture provides both depth and depth/stencil textures. </li>
      <li> ANGLE_depth_texture does not provide the <code>DEPTH24_STENCIL8_OES</code> renderbuffer internal format from the OES_packed_depth_stencil extension. The core WebGL specification already supports allocation of depth/stencil renderbuffers. </li>
      <li> ANGLE_depth_texture does not support loading image data via the TexImage or TexSubImage commands. Depth and depth/stencil textures created via this extension can only have their contents specified by rendering to them. </li>
      </ul>

    </p>

    <p>Consult the Errors section below for specific restrictions.
    </p>

    <p> When this extension is enabled: </p>
<ul>
<li>
        The <code>texImage2D</code> entry point is extended to accept the
        <code>format</code> parameter <code>DEPTH_COMPONENT</code> and
        <code>DEPTH_STENCIL</code>
      </li>
<li>
        The <code>texImage2D</code> entry point is extended to accept the
        <code>internalFormat</code> parameter <code>DEPTH_COMPONENT</code>
        and <code>DEPTH_STENCIL</code>
      </li>
<li>
        The <code>texImage2D</code> entry point is extended to accept
        the <code>type</code> parameter <code>UNSIGNED_SHORT</code>,
        <code>UNSIGNED_INT</code>, and
        <code>UNSIGNED_INT_24_8_WEBGL</code>
      </li>
<li>
        The <code>framebufferTexture2D</code> entry point is extended to
        accept the <code>target</code> parameter
        <code>DEPTH_ATTACHMENT</code> and
        <code>DEPTH_STENCIL_ATTACHMENT</code>
      </li>
<li>
        The <code>texImage2D</code> entry point is extended to accept
        <code>ArrayBufferView</code> of type <code>Uint16Array</code> and
        <code>Uint32Array</code>
      </li>
<li>
        <p>
          The WebGL-specific constraints about <a href="http://www.khronos.org/registry/webgl/specs/1.0/#6.5">Framebuffer Object Attachments</a> are extended:

          <ul>
          <li> A texture attached to an FBO's <code>DEPTH_ATTACHMENT</code> attachment point must be allocated with the <code>DEPTH_COMPONENT</code> internal format. </li>
          <li> A texture attached to the <code>DEPTH_STENCIL_ATTACHMENT</code> attachment point must be allocated with the <code>DEPTH_STENCIL</code> internal format. </li>
          </ul>
        </p>
        <p>
          In the WebGL API, it is an error to concurrently attach either
          renderbuffers or textures to the following combinations of
          attachment points:

          <ul>
          <li> <code>DEPTH_ATTACHMENT</code> + <code>DEPTH_STENCIL_ATTACHMENT</code> </li>
          <li> <code>STENCIL_ATTACHMENT</code> + <code>DEPTH_STENCIL_ATTACHMENT</code> </li>
          <li> <code>DEPTH_ATTACHMENT</code> + <code>STENCIL_ATTACHMENT</code> </li>
          </ul>
        </p>
        <p>
          See the section
          <a href="http://www.khronos.org/registry/webgl/specs/1.0/#6.5">Framebuffer Object Attachments</a>
          in the WebGL specification for the behavior if these
          constraints are violated.
        </p>
      </li>
</ul>
  <h2 class="no-toc">Alias Name Strings (for draft extensions)</h2>
<ul>
<li>WEBKIT_WEBGL_depth_texture</li>
<li>MOZ_WEBGL_depth_texture</li>
</ul>
<h2 class="no-toc">IDL</h2>
<p><pre class="idl">
interface WEBGL_depth_texture {
  const GLenum UNSIGNED_INT_24_8_WEBGL = 0x84FA;
};
  </pre></p>
<h2 class="no-toc">Errors</h2>
<p>
      The error <code>INVALID_OPERATION</code> is generated by
      <code>texImage2D</code> if the <code>format</code> parameter is
      <code>DEPTH_COMPONENT</code> or <code>DEPTH_STENCIL</code> and the
      <code>target</code> is
      <code>TEXTURE_CUBE_MAP_{POSITIVE,NEGATIVE}_{X,Y,Z}</code>.
    </p>
<p>
      The error <code>INVALID_OPERATION</code> is generated by
      <code>texImage2D</code> if <code>format</code> and
      <code>internalformat</code> are <code>DEPTH_COMPONENT</code> and
      <code>type</code> is not <code>UNSIGNED_SHORT</code> or
      <code>UNSIGNED_INT</code>.
    </p>
<p>
       The error <code>INVALID_OPERATION</code> is generated by
       <code>texImage2D</code> if <code>format</code> and
       <code>internalformat</code> are not <code>DEPTH_COMPONENT</code>
       and <code>type</code> is <code>UNSIGNED_SHORT</code> or
       <code>UNSIGNED_INT</code>.
    </p>
<p>
      The error <code>INVALID_OPERATION</code> is generated by
      <code>texImage2D</code> if <code>format</code> and
      <code>internalformat</code> are <code>DEPTH_STENCIL</code> and
      <code>type</code> is not <code>UNSIGNED_INT_24_8_WEBGL</code>.
    </p>
<p>
      The error <code>INVALID_OPERATION</code> is generated by
      <code>texImage2D</code> if <code>format</code> and
      <code>internalformat</code> are not <code>DEPTH_STENCIL</code> and
      <code>type</code> is <code>UNSIGNED_INT_24_8_WEBGL</code>.
    </p>
<p>
      The error <code>INVALID_OPERATION</code> is generated in the following situations:
      <ul>
        <li>
          <code>texImage2D</code> is called with <code>format</code> and
          <code>internalformat</code> of <code>DEPTH_COMPONENT</code> or
          <code>DEPTH_STENCIL</code> and
          <ul>
            <li> <code>target</code> is not TEXTURE_2D, </li>
            <li> <code>data</code> is not NULL, or </li>
            <li> <code>level</code> is not zero. </li>
          </ul>
        </li>
        <li>
          <code>texSubImage2D</code> is called with <code>format</code> of
          <code>DEPTH_COMPONENT</code> or <code>DEPTH_STENCIL</code>.
        </li>
        <li>
          <code>copyTexImage2D</code> is called with an
          <code>internalformat</code> that has a base internal format of
          <code>DEPTH_COMPONENT</code> or <code>DEPTH_STENCIL</code>.
        </li>
        <li>
          <code>copyTexSubImage2D</code> is called with a target texture
          that has a base internal format of <code>DEPTH_COMPONENT</code>
          or <code>DEPTH_STENCIL</code>.
        </li>
        <li>
          <code>generateMipmap</code> is called on a texture that has a
          base internal format of <code>DEPTH_COMPONENT</code> or
          <code>DEPTH_STENCIL</code>.
        </li>
      </ul>
    </p>
<h2 class="no-toc">Issues</h2>
    <issue>
      <p>
        As per the ANGLE_depth_texture specification, the contents of the
        ALPHA channel when sampling a depth texture is implementation
        dependent. It can be either another copy of the depth value that is
        stored in the LUMIANCE channels, <code>r</code>, <code>g</code>,
        and <code>b</code>, it can be 1.0
      </p>
      <p>
        It is therefore recommended to use <code>r</code>,
        <code>g</code>, or <code>b</code> in GLSL shaders
        that are used to reference depth textures.
      </p>
    </issue>
  <h2 class="no-toc">Revision History</h2>
<p>Revision 1, 2012/01/23</p>
<ul><li>Initial revision.</li></ul>
<p>Revision 2, 2012/01/25</p>
<ul><li>Added provisions to exclude cube depth textures.</li></ul>
<p>Revision 3, 2012/02/06</p>
<ul><li>Changed referenced WebGL API version from 2.0 to 1.0</li></ul>
<p>Revision 4, 2012/02/24</p>
<ul><li>Removed the enumerants from the IDL which are contained in the context and added aliases to the extension name</li></ul>
<p>Revision 5, 2012/03/01</p>
<ul><li>
        Renamed with OES prefix and removed the addendum due to expected harmonization between OES_depth_texture and ARB_depth_texture
        (depth cube maps).
      </li></ul>
<p>Revision 6, 2012/06/04</p>
<ul><li>
        Renamed to WEBGL prefix, and changed to reference ANGLE_depth_texture, because of
        limitations preventing the current ANGLE library from loading of image data to depth
        textures. Incorporated errors from ANGLE_depth_texure extension specification.
      </li></ul>
<p>Revision 7, 2012/06/20</p>
<ul><li>
        Incorporated depth/stencil support and UNSIGNED_INT_24_8_WEBGL enum after discussion on
        public_webgl mailing list, including supported behavior and additional error behavior.
        Extended rules in Section 6.5 ("Framebuffer Object Attachments") to handle texture
        attachments.
      </li></ul>
<p>Revision 8, 2012/06/27</p>
<ul><li>
        Updated references to texSubImage2D. Added
        DEPTH_STENCIL_ATTACHMENT to framebufferTexture2D.
      </li></ul>
</body>
</html>
